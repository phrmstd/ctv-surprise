<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–°—é—Ä–ø—Ä–∏–∑ –¥–Ω—è</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin:0; padding:24px; background:#fafafa; }
    .card { max-width: 560px; margin: 0 auto; border: 1px solid #e5e7eb; border-radius: 16px; padding: 20px; background:#fff; box-shadow: 0 10px 30px rgba(0,0,0,0.06); }
    h1 { font-size: 22px; margin: 0 0 8px; }
    p { margin: 0 0 12px; line-height: 1.5; }
    .muted { color:#6b7280; font-size: 14px; }
    .msg { font-size: 20px; font-weight: 600; margin: 16px 0; }
    .btn { display:inline-block; padding:10px 16px; border-radius: 10px; border:1px solid #e5e7eb; background:#fff; cursor:pointer; }
    .btn.ok { background:#10b981; color:#fff; border:none; }
    .row { display:flex; gap:8px; align-items:center; }
    input { padding:8px 10px; border-radius:10px; border:1px solid #e5e7eb; width:100%; }
    .hidden { display:none; }
  </style>
</head>
<body>
  <div class="card">
    <h1>–°—é—Ä–ø—Ä–∏–∑ –¥–Ω—è üéÅ</h1>
    <div id="gate" class="hidden">
      <p>–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –¥–Ω—è —Å —ç–∫—Ä–∞–Ω–∞:</p>
      <div class="row">
        <input id="codeInput" placeholder="–°–ª–æ–≤–æ –¥–Ω—è"/>
        <button class="btn ok" id="unlockBtn">–û—Ç–∫—Ä—ã—Ç—å</button>
      </div>
      <p id="gateHint" class="muted"></p>
    </div>
    <div id="content" class="hidden">
      <div class="msg" id="message"></div>
    </div>
  </div>

<script>
/*
  –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞:
  1) –ú–µ–Ω—è–π—Ç–µ —Å–ø–∏—Å–æ–∫ MESSAGES –Ω–∏–∂–µ –ø–æ–¥ –≤–∞—à–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è/—Ü–∏—Ç–∞—Ç—ã/—Ñ–∞–∫—Ç—ã.
  2) –°—Å—ã–ª–∫–∞ –±–µ–∑ –∫–æ–¥–∞: .../surprise_v2.html?src=lunch (–∏–ª–∏ src=all)
     –°—Å—ã–ª–∫–∞ —Å –∫–æ–¥–æ–º-—Å–ª–æ–≤–æ–º: .../surprise_v2.html?src=lunch&gate=1&code=–°–û–õ–ù–¶–ï
  3) –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ "1 —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –¥–µ–Ω—å –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ" —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ localStorage –±—Ä–∞—É–∑–µ—Ä–∞.
     –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤ –¥—Ä—É–≥–æ–º –±—Ä–∞—É–∑–µ—Ä–µ/—É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –∑–∞–Ω–æ–≤–æ.
*/

const MESSAGES = [
  "–•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è! –ü—É—Å—Ç—å –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è ‚ú®",
  "–ú–∏–Ω–∏-—Å–æ–≤–µ—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –¥–µ—Ä–∂–∏—Ç–µ—Å—å –∑–∞ –ø–æ—Ä—É—á–µ–Ω—å –Ω–∞ –ª–µ—Å—Ç–Ω–∏—Ü–µ.",
  "–§–∞–∫—Ç –æ –∫–æ–º–ø–∞–Ω–∏–∏: –º—ã –≤–º–µ—Å—Ç–µ —É–∂–µ X –ª–µ—Ç ‚Äî —Å–ø–∞—Å–∏–±–æ –≤–∞–º!",
  "–ò–¥–µ—è –¥–Ω—è: 3 –≥–ª—É–±–æ–∫–∏—Ö –≤–¥–æ—Ö–∞ –ø–µ—Ä–µ–¥ —Å–ª–æ–∂–Ω–æ–π –∑–∞–¥–∞—á–µ–π.",
  "–¶–∏—Ç–∞—Ç–∞: ¬´–°–∞–º—ã–π —Ç—ë–º–Ω—ã–π —á–∞—Å ‚Äî –ø–µ—Ä–µ–¥ —Ä–∞—Å—Å–≤–µ—Ç–æ–º¬ª.",
  "–°–æ–≤–µ—Ç –ø–æ —Ñ–æ–∫—É—Å—É: 25 –º–∏–Ω—É—Ç —Ä–∞–±–æ—Ç—ã, 5 –º–∏–Ω—É—Ç –ø–∞—É–∑–∞ ‚Äî –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–µ–≥–æ–¥–Ω—è.",
  "–°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω—ã–π –ø–æ–≤–æ–¥ —É–ª—ã–±–Ω—É—Ç—å—Å—è –∫–æ–ª–ª–µ–≥–µ —Å–ø—Ä–∞–≤–∞ üôÇ",
  "–ú–∞–ª–µ–Ω—å–∫–∞—è –ø–æ–±–µ–¥–∞ ‚Äî —Ç–æ–∂–µ –ø–æ–±–µ–¥–∞. –ó–∞–º–µ—Ç—å—Ç–µ –µ—ë —Å–µ–≥–æ–¥–Ω—è."
];

function pickRandom(arr){ return arr[Math.floor(Math.random()*arr.length)] }

// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
const params = new URLSearchParams(location.search);
const gate = params.get('gate') === '1';
const code = params.get('code') || ""; // —Å–ª–æ–≤–æ –¥–Ω—è, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞
const src = params.get('src') || "";   // lunch / all (–¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —á–µ—Ä–µ–∑ —à–æ—Ä—Ç—Å—Å—ã–ª–∫–∏)

const gateEl = document.getElementById('gate');
const contentEl = document.getElementById('content');
const messageEl = document.getElementById('message');
const gateHint = document.getElementById('gateHint');

function todayKey() {
  const d = new Date();
  return d.getFullYear() + "-" + String(d.getMonth()+1).padStart(2,"0") + "-" + String(d.getDate()).padStart(2,"0");
}

function getStored() {
  try { return JSON.parse(localStorage.getItem("surprise_v2") || "{}"); } catch(e){ return {}; }
}
function setStored(obj) {
  localStorage.setItem("surprise_v2", JSON.stringify(obj));
}

function showMessageOncePerDay() {
  const key = todayKey();
  const store = getStored();
  if (store.date === key && typeof store.msgIndex === "number") {
    // –£–∂–µ –æ—Ç–∫—Ä—ã–≤–∞–ª–∏ —Å–µ–≥–æ–¥–Ω—è ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ –∂–µ —Å–∞–º–æ–µ
    messageEl.textContent = MESSAGES[store.msgIndex] || MESSAGES[0];
    contentEl.classList.remove('hidden');
    return;
  }
  // –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å–µ–≥–æ–¥–Ω—è ‚Äî —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —Å–æ—Ö—Ä–∞–Ω—è–µ–º
  const idx = Math.floor(Math.random()*MESSAGES.length);
  messageEl.textContent = MESSAGES[idx];
  setStored({ date: key, msgIndex: idx });
  contentEl.classList.remove('hidden');
}

function unlock() {
  const v = document.getElementById('codeInput').value.trim();
  if (!code) { showMessageOncePerDay(); return; }
  if (v && v.toLowerCase() === code.toLowerCase()) {
    showMessageOncePerDay();
  } else {
    gateHint.textContent = "–ù–µ–≤–µ—Ä–Ω–æ–µ —Å–ª–æ–≤–æ. –ü–æ–¥—Å–∫–∞–∑–∫–∞ –±—ã–ª–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Ä—è–¥–æ–º —Å QR.";
  }
}

function init() {
  if (gate) {
    gateEl.classList.remove('hidden');
    document.getElementById('unlockBtn').addEventListener('click', unlock);
  } else {
    showMessageOncePerDay();
  }
}

init();
</script>
</body>
</html>