<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–°—é—Ä–ø—Ä–∏–∑ –¥–Ω—è</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin:0; padding:24px; background:#fafafa; }
    .card { max-width: 560px; margin: 0 auto; border: 1px solid #e5e7eb; border-radius: 16px; padding: 20px; background:#fff; box-shadow: 0 10px 30px rgba(0,0,0,0.06); }
    h1 { font-size: 22px; margin: 0 0 8px; }
    .muted { color:#6b7280; font-size: 14px; }
    .msg { font-size: 20px; font-weight: 600; margin: 16px 0; }
    .row { display:flex; gap:8px; align-items:center; }
    input { padding:8px 10px; border-radius:10px; border:1px solid #e5e7eb; width:100%; }
    .hidden { display:none; }
  </style>
</head>
<body>
  <div class="card">
    <h1>–°—é—Ä–ø—Ä–∏–∑ –¥–Ω—è üéÅ</h1>

    <div id="gate" class="hidden">
      <p>–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –¥–Ω—è —Å —ç–∫—Ä–∞–Ω–∞:</p>
      <div class="row">
        <input id="codeInput" placeholder="–°–ª–æ–≤–æ –¥–Ω—è"/>
        <button id="unlockBtn">–û—Ç–∫—Ä—ã—Ç—å</button>
      </div>
      <p id="gateHint" class="muted"></p>
    </div>

    <div id="content" class="hidden">
      <div class="msg" id="message"></div>
    </div>
  </div>

  <!-- –õ–û–ì–ò–ö–ê –°–¢–†–ê–ù–ò–¶–´ -->
  <script>
    const MESSAGES = [
      "–•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è! –ü—É—Å—Ç—å –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è ‚ú®",
      "–ú–∏–Ω–∏-—Å–æ–≤–µ—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –¥–µ—Ä–∂–∏—Ç–µ—Å—å –∑–∞ –ø–æ—Ä—É—á–µ–Ω—å –Ω–∞ –ª–µ—Å—Ç–Ω–∏—Ü–µ.",
      "–§–∞–∫—Ç –æ –∫–æ–º–ø–∞–Ω–∏–∏: –º—ã –≤–º–µ—Å—Ç–µ —É–∂–µ X –ª–µ—Ç ‚Äî —Å–ø–∞—Å–∏–±–æ –≤–∞–º!",
      "–ò–¥–µ—è –¥–Ω—è: 3 –≥–ª—É–±–æ–∫–∏—Ö –≤–¥–æ—Ö–∞ –ø–µ—Ä–µ–¥ —Å–ª–æ–∂–Ω–æ–π –∑–∞–¥–∞—á–µ–π.",
      "–¶–∏—Ç–∞—Ç–∞: ¬´–°–∞–º—ã–π —Ç—ë–º–Ω—ã–π —á–∞—Å ‚Äî –ø–µ—Ä–µ–¥ —Ä–∞—Å—Å–≤–µ—Ç–æ–º¬ª.",
      "–°–æ–≤–µ—Ç –ø–æ —Ñ–æ–∫—É—Å—É: 25 –º–∏–Ω—É—Ç —Ä–∞–±–æ—Ç—ã, 5 –º–∏–Ω—É—Ç –ø–∞—É–∑–∞ ‚Äî –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–µ–≥–æ–¥–Ω—è.",
      "–°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω—ã–π –ø–æ–≤–æ–¥ —É–ª—ã–±–Ω—É—Ç—å—Å—è –∫–æ–ª–ª–µ–≥–µ —Å–ø—Ä–∞–≤–∞ üôÇ",
      "–ú–∞–ª–µ–Ω—å–∫–∞—è –ø–æ–±–µ–¥–∞ ‚Äî —Ç–æ–∂–µ –ø–æ–±–µ–¥–∞. –ó–∞–º–µ—Ç—å—Ç–µ –µ—ë —Å–µ–≥–æ–¥–Ω—è."
    ];

    function todayKey(){
      const d = new Date();
      return d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0")+"-"+String(d.getDate()).padStart(2,"0");
    }
    function getStored(){ try { return JSON.parse(localStorage.getItem("surprise_v2")||"{}"); } catch(e){ return {}; } }
    function setStored(obj){ localStorage.setItem("surprise_v2", JSON.stringify(obj)); }

    const params   = new URLSearchParams(location.search);
    const gate     = params.get('gate') === '1';
    const code     = params.get('code') || "";
    const gateEl   = document.getElementById('gate');
    const contentEl= document.getElementById('content');
    const messageEl= document.getElementById('message');
    const gateHint = document.getElementById('gateHint');

    function showMessageOncePerDay(){
      const key   = todayKey();
      const store = getStored();
      if (store.date === key && typeof store.msgIndex === "number"){
        messageEl.textContent = MESSAGES[store.msgIndex] || MESSAGES[0];
        contentEl.classList.remove('hidden');
        return;
      }
      const idx = Math.floor(Math.random()*MESSAGES.length);
      messageEl.textContent = MESSAGES[idx];
      setStored({ date:key, msgIndex:idx });
      contentEl.classList.remove('hidden');
    }

    function unlock(){
      const v = document.getElementById('codeInput').value.trim();
      if (!code) { showMessageOncePerDay(); return; }
      if (v && v.toLowerCase() === code.toLowerCase()){
        showMessageOncePerDay();
      } else {
        gateHint.textContent = "–ù–µ–≤–µ—Ä–Ω–æ–µ —Å–ª–æ–≤–æ. –ü–æ–¥—Å–∫–∞–∑–∫–∞ –±—ã–ª–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Ä—è–¥–æ–º —Å QR.";
      }
    }

    (function init(){
      if (gate){
        gateEl.classList.remove('hidden');
        document.getElementById('unlockBtn').addEventListener('click', unlock);
      } else {
        showMessageOncePerDay();
      }
    })();
  </script>

  <!-- –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞ (–µ–¥–∏–Ω—ã–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –±–ª–æ–∫) -->
  <script type="text/javascript">
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();for (var j=0;j<document.scripts.length;j++){if(document.scripts[j].src===r){return;}}
    k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");

    ym(104398970,"init",{clickmap:true,trackLinks:true,accurateTrackBounce:true,webvisor:true});
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/104398970" style="position:absolute; left:-9999px;" alt=""/></div></noscript>

  <!-- –ü–µ—Ä–µ–¥–∞—ë–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∏–∑–∏—Ç–∞ + —Å–æ–±—ã—Ç–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è -->
  <script>
    (function(){
      var p = new URLSearchParams(location.search);
      var src  = p.get('src')  || 'unknown';
      var site = p.get('site') || 'default';
      if (window.ym){
        ym(104398970, 'params', { src: src, site: site });
        ym(104398970, 'reachGoal', 'open', { src: src, site: site });
      }
    })();
  </script>
  <script>
(function(){
  function log(){ try{ console.log.apply(console, arguments); }catch(e){} }

  // 1) –ü—Ä–æ–≤–µ—Ä–∏–º, –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –ª–∏ –ú–µ—Ç—Ä–∏–∫–∞
  if (typeof ym !== 'function') {
    log('[YM] not loaded');
    const warn = document.createElement('div');
    warn.textContent = '–ú–µ—Ç—Ä–∏–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å (ym undefined)';
    warn.style.cssText='position:fixed;bottom:10px;left:10px;background:#fee;border:1px solid #f99;padding:6px 10px;border-radius:8px;font:12px/1.3 system-ui';
    document.body.appendChild(warn);
    return;
  }

  // 2) –û—Ç–ø—Ä–∞–≤–∏–º —Ö–∏—Ç –∏ —Ü–µ–ª—å, –∑–∞–æ–¥–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏–º –æ—Ç–≤–µ—Ç
  const id = 104398970;

  // –ü—Ä–æ–±—É–µ–º –æ–±—ã—á–Ω—ã–π hit/goal
  ym(id, 'hit', location.href, { params: { src: 'diag' } });
  ym(id, 'reachGoal', 'open', { src: 'diag' });
  log('[YM] hit+goal queued');

  // 3) –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∂–µ–º, –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ watch
  const url = 'https://mc.yandex.ru/watch/' + id +
              '?page-url=' + encodeURIComponent(location.href) +
              '&browser-info=ti:1:';
  const img = new Image();
  img.onload  = function(){ log('[YM] watch pixel loaded OK'); };
  img.onerror = function(){ log('[YM] watch pixel blocked'); 
    const w=document.createElement('div');
    w.textContent='–ü–∏–∫—Å–µ–ª—å watch –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–µ—Ç—å/—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ/DNS).';
    w.style.cssText='position:fixed;bottom:10px;left:10px;background:#ffe;border:1px solid #dd0;padding:6px 10px;border-radius:8px;font:12px/1.3 system-ui';
    document.body.appendChild(w);
  };
  img.src = url + '&rand=' + Math.random();
})();
</script>

</body>
</html>
